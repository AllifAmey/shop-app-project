import{H as S,r as d,an as I,ao as _,j as e,F as x,d as k,G as t,b as u,B as D,L as f}from"./index-28587765.js";import{C as N}from"./CircularProgress-09804be8.js";import{T as p}from"./TextField-9b2d7ae8.js";import"./useFormControl-af2eded4.js";async function v(i,l,c){i(!0);let n=await fetch(`${S}/api/user/token/`,{method:"POST",body:JSON.stringify({email:l,password:c}),headers:{"Content-type":"application/json"}});if(n.ok){let r=await n.json();return localStorage.setItem("Token",r.token),localStorage.setItem("isLogged","LOGGED_IN"),n=await fetch(`${S}/api/user/me/`,{method:"GET",headers:{"Content-type":"application/json",Authorization:`Token ${r.token}`}}),n.ok?(r=await n.json(),i(!1),r):(i(!1),"error")}else return i(!1),"error"}async function P(i,l,c,n){i(!0);const m=await(await fetch(`${S}/api/user/create/`,{method:"POST",body:JSON.stringify({name:l,email:c,password:n}),headers:{"Content-type":"application/json"}})).json();console.log(m),i(!1)}function z(i){return i.split("_").map(n=>n[0].toUpperCase()+n.substring(1)).join(" ")}function W(i){const[l,c]=d.useState(""),[n,r]=d.useState(""),[m,C]=d.useState(""),[b,h]=d.useState(!1),y=I(),j=_(),s=z(j.accessType),w=async o=>{if(o.preventDefault(),s=="Login"){const a=await v(h,n,m);if(a!="error"){a.user_status=="member"?localStorage.setItem("username",a.name):a.user_status=="staff"&&localStorage.setItem("username",a.email);const g=localStorage.getItem("username");localStorage.setItem("user_id",a.user_id),localStorage.setItem("user_status",a.user_status),y(`/account/${a.user_status}/${g}`)}}else if(s=="Sign Up"){await P(h,l,n,m);const a=await v(h,n,m);a.user_status=="member"?localStorage.setItem("username",a.name):a.user_status=="staff"&&localStorage.setItem("username",a.email);const g=localStorage.getItem("username");localStorage.setItem("user_id",a.user_id),localStorage.setItem("user_status",a.user_status),y(`/account/${a.user_status}/${g}`)}};return e(x,{children:b?e(N,{size:"25rem",sx:{margin:"auto"}}):e(k,{height:"auto",width:1,children:e("form",{noValidate:!0,autoComplete:"off",onSubmit:w,children:e(t,{container:!0,justifyContent:"center",alignItems:"center",height:"100vh",width:.8,margin:"0 auto",children:u(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"start",width:.5,height:1,children:[u(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"center",height:.3,children:[e(t,{item:!0,fontSize:44,children:"Amey Jewellery"}),e(t,{item:!0,fontSize:30,fontWeight:800,children:s})]}),u(t,{item:!0,container:!0,flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",padding:"1rem",height:.6,children:[s==="Sign Up"&&u(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"start",width:.8,gap:2,children:[e(t,{item:!0,children:"Name"}),e(t,{item:!0,width:1,children:e(p,{fullWidth:!0,id:"outlined-basic",label:"Name",variant:"outlined",size:"big",onChange:o=>{c(o.target.value)},required:!0})})]}),u(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"start",width:.8,gap:2,children:[e(t,{item:!0,children:"Email Address"}),e(t,{item:!0,width:1,children:e(p,{fullWidth:!0,id:"outlined-basic",label:"Email",variant:"outlined",size:"big",onChange:o=>{r(o.target.value)},required:!0})})]}),["Login","Sign Up"].includes(s)&&u(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"start",width:.8,gap:2,children:[e(t,{item:!0,textAlign:"start",children:"Password"}),e(t,{item:!0,width:1,children:e(p,{fullWidth:!0,id:"outlined-basic",label:"Password",variant:"outlined",size:"big",onChange:o=>{C(o.target.value)},required:!0})})]}),e(t,{item:!0,width:.5,children:e(D,{variant:"outlined",size:"big",fullWidth:!0,onClick:w,children:s})}),s=="Login"?u(t,{item:!0,container:!0,justifyContent:"space-evenly",children:[e(t,{item:!0,component:f,to:"/account/sign_up",children:"Don't have account?"}),e(t,{item:!0,component:f,to:"/account/recover",children:"Forgot password?"})]}):e(t,{item:!0,component:f,to:"/account/login",children:"Have an account?"})]})]})})})})})}export{W as default};
