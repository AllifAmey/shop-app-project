import{j as e,y as N,b as f,E as b,r as c,aj as W,x as $,F as U,G as u,I as p,N as q,B as g,L as D,D as H}from"./index-fb1067bf.js";import{B as J,a as I,d as K,b as Q,D as X,N as Y,m as Z}from"./MassDeleteAPI-83fcb04e.js";import{g as ee,b as te,c as ae}from"./OrderAPI-87c673a1.js";import{C as re}from"./LastPage-5af58c1b.js";import"./ListItemText-ded7936e.js";import"./SwitchBase-e22c3396.js";function ie(r){function h(m){m==0?b(r.setIsLoading).then(l=>{r.setIsLoading(!0);let a=[];l.forEach(i=>{a.push({id:i.id,product_name:i.name,price:i.price,catagory:i.catagory})}),r.setrowValue(a),r.setIsLoading(!1)}):m==1&&ee(r.setIsLoading).then(l=>{let a=[],i=[];l.forEach(n=>{a.push({id:n.id,username:n.user,email:n.email,view:"Click me!",totalPrice:n.total_price,deliveryStatus:n.delivery_status}),i.push(n)}),r.setrowValue(a),r.setRowDetail(i),r.setIsLoading(!1)})}return e(N,{sx:{width:800},children:f(J,{showLabels:!0,value:r.navValue,onChange:(m,l)=>{h(l),r.setNavValue(l)},children:[e(I,{label:"Products",icon:e(K,{})}),e(I,{label:"Orders",icon:e(Q,{})})]})})}function ue(r){const[h,m]=c.useState(0),[l,a]=c.useState(!1),[i,n]=c.useState(),[O,x]=c.useState([]),[y,k]=c.useState(),[L,j]=c.useState(!1),[S,C]=c.useState(!1),[_,w]=c.useState(!1),P=()=>{w(!0)},E=()=>{w(!1)},V=W(),R=$(),A=[{field:"id",headerName:"ID",width:70},{field:"username",headerName:"User",width:70},{field:"email",headerName:"Email",width:200},{field:"view",headerName:"View Order",renderCell:t=>e("strong",{children:e(g,{variant:"contained",size:"small",style:{marginLeft:16},tabIndex:t.hasFocus?0:-1,onClick:()=>{k(t.id),P()},children:"Open"})}),width:120},{field:"totalPrice",headerName:"Total Price",type:"number",width:100},{field:"deliveryStatus",headerName:"Delivery Status",width:150},{field:"dispatch",headerName:"Dispatched?",renderCell:t=>{let s;return t.row.deliveryStatus=="Dispatched"?s=!0:s=!1,e("strong",{children:e(re,{checked:s,onChange:d=>{const o=t.id,v=d.target.checked;te(a,o).then(M=>{ae(a,o,M,v).then(T=>{l||(t.row.deliveryStatus=T.delivery_status)})})}})})},width:120}],B=[{field:"id",headerName:"ID",width:70},{field:"product_name",headerName:"Product",width:90},{field:"price",headerName:"Price",width:90},{field:"catagory",headerName:"Catagory",type:"number",width:150},{field:"detailed_view",headerName:"View details",type:"number",width:150}];c.useEffect(()=>{let t=localStorage.getItem("username");t!=null&&(V(`/account/${t}/`,{replace:!0}),n([])),b(a).then(s=>{a(!0);let d=[];s.forEach(o=>{d.push({id:o.id,product_name:o.name,price:o.price,catagory:o.catagory})}),n(d),a(!1)})},[]);function z(){const t=[...O],s=i;let d=[...i],o=0;R(H.changeItem(["delete",t])),s.forEach(v=>{t.includes(v.id)&&d.splice(o,1),o++}),n(d),Z(a,"cart",t)}function G(){localStorage.removeItem("Token"),localStorage.removeItem("username"),localStorage.removeItem("isLogged"),localStorage.removeItem("user_id"),localStorage.removeItem("user_status"),r.logOut(!1)}function F(t){return t.id==y}return f(U,{children:[l?e(u,{container:!0,justifyContent:"center",children:e(p,{size:"25rem",sx:{margin:"auto"}})}):i==null?e(u,{container:!0,justifyContent:"center",children:e(p,{size:"25rem",sx:{margin:"auto"}})}):e(N,{height:"100vh",children:e(q,{maxWidth:"lg",children:f(u,{padding:"2rem 0",container:!0,flexDirection:"column",justifyContent:"center",alignItems:"center",gap:2,children:[f(u,{item:!0,justifyContent:"center",children:["Welcome back, ",localStorage.getItem("username")]}),e(u,{item:!0,container:!0,justifyContent:"center",children:e(ie,{setIsLoading:a,setrowValue:n,setNavValue:m,navValue:h,setRowDetail:j})}),e(u,{item:!0,container:!0,justifyContent:"center",width:"75vw",children:e("div",{style:{height:400,width:"60%"},children:e(X,{rows:i,columns:h==0?B:A,pageSize:5,rowsPerPageOptions:[5],checkboxSelection:!0,disableSelectionOnClick:!0,disableColumnSelector:!0,onSelectionModelChange:t=>{const s=new Set(t);x(s),[...s].length==0?C(!1):C(!0)}})})}),f(u,{item:!0,container:!0,justifyContent:S?"space-between":"space-evenly",height:.2,width:.5,children:[S?e(g,{variant:"contained",sx:{color:"red"},onClick:z,children:"Delete items"}):"",h==0?e(g,{variant:"contained",component:D,to:"create/product",children:"Add Product"}):"",e(g,{variant:"contained",component:D,to:"/account/login",onClick:G,children:"Log out"})]})]})})}),h==1&&e(Y,{open:_,setOpen:w,handleClose:E,rowDetail:_&&L.filter(F),checkOrderId:y})]})}export{ue as default};
