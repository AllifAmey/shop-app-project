import{ai as f,r as d,J as j,j as e,F as v,I as b,y as x,G as t,b as l,U as h,B as I,L as g}from"./index-fb1067bf.js";async function y(n,u,c,a){n(!0);let r=await fetch(`${f}/api/user/token/`,{method:"POST",body:JSON.stringify({email:c,password:a}),headers:{"Content-type":"application/json"}});if(r.status==400){n(!1);return}let i=await r.json();localStorage.setItem("Token",i.token),localStorage.setItem("isLogged","LOGGED_IN"),r=await fetch(`${f}/api/user/me/`,{method:"GET",headers:{"Content-type":"application/json",Authorization:`Token ${i.token}`}}),i=await r.json(),i.user_status=="member"?localStorage.setItem("username",i.name):i.user_status=="staff"&&localStorage.setItem("username",i.email),localStorage.setItem("user_id",i.user_id),localStorage.setItem("user_status",i.user_status),n(!1),u(!0)}async function D(n,u,c,a){n(!0);const i=await(await fetch(`${f}/api/user/create/`,{method:"POST",body:JSON.stringify({name:u,email:c,password:a}),headers:{"Content-type":"application/json"}})).json();console.log(i),n(!1)}function P(n){return n.split("_").map(a=>a[0].toUpperCase()+a.substring(1)).join(" ")}function z(n){const[u,c]=d.useState(""),[a,r]=d.useState(""),[i,w]=d.useState(""),[S,m]=d.useState(!1),C=j(),s=P(C.accessType),p=async o=>{o.preventDefault(),s=="Login"?await y(m,n.login,a,i):s=="Sign Up"&&(await D(m,u,a,i),await y(m,n.login,a,i))};return e(v,{children:S?e(b,{size:"25rem",sx:{margin:"auto"}}):e(x,{height:"auto",width:1,children:e("form",{noValidate:!0,autoComplete:"off",onSubmit:p,children:e(t,{container:!0,justifyContent:"center",alignItems:"center",height:"100vh",width:.8,margin:"0 auto",children:l(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"start",width:.5,height:1,children:[l(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"center",height:.3,children:[e(t,{item:!0,fontSize:44,children:"Amey Jewellery"}),e(t,{item:!0,fontSize:30,fontWeight:800,children:s})]}),l(t,{item:!0,container:!0,flexDirection:"column",alignItems:"center",justifyContent:"space-evenly",padding:"1rem",height:.6,children:[s==="Sign Up"&&l(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"start",width:.8,gap:2,children:[e(t,{item:!0,children:"Name"}),e(t,{item:!0,width:1,children:e(h,{fullWidth:!0,id:"outlined-basic",label:"Name",variant:"outlined",size:"big",onChange:o=>{c(o.target.value)},required:!0})})]}),l(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"start",width:.8,gap:2,children:[e(t,{item:!0,children:"Email Address"}),e(t,{item:!0,width:1,children:e(h,{fullWidth:!0,id:"outlined-basic",label:"Email",variant:"outlined",size:"big",onChange:o=>{r(o.target.value)},required:!0})})]}),["Login","Sign Up"].includes(s)&&l(t,{item:!0,container:!0,flexDirection:"column",justifyContent:"space-evenly",alignItems:"start",width:.8,gap:2,children:[e(t,{item:!0,textAlign:"start",children:"Password"}),e(t,{item:!0,width:1,children:e(h,{fullWidth:!0,id:"outlined-basic",label:"Password",variant:"outlined",size:"big",onChange:o=>{w(o.target.value)},required:!0})})]}),e(t,{item:!0,width:.5,children:e(I,{variant:"outlined",size:"big",fullWidth:!0,onClick:p,children:s})}),s=="Login"?l(t,{item:!0,container:!0,justifyContent:"space-evenly",children:[e(t,{item:!0,component:g,to:"/account/sign_up",children:"Don't have account?"}),e(t,{item:!0,component:g,to:"/account/recover",children:"Forgot password?"})]}):e(t,{item:!0,component:g,to:"/account/login",children:"Have an account?"})]})]})})})})})}export{z as default};
